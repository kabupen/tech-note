+++
title = 'ワルド検定'
date = 2024-10-01
draft = false
categories = ["統計"]
tags = []
+++

# ワルド検定

## はじめに

尤度比検定では、尤度比

$$
\lambda(X) = \frac{L(\theta_0, X)}{L(\hat{\theta}, X)}
$$

を用いた $-2 \log \lambda(X)$ が帰無仮説 $H_0 : \theta = \theta_0$ の下で自由度1のカイ二乗分布 $\chi_1^2$ に分布収束することを用いました。では、ワルド検定（ワルド型検定）と呼ばれる手法ではどのような検定統計量を用いた計算を行っていくのでしょうか？


### 補足

尤度比検定量の導出の過程を考えると、帰無仮説は $\theta=\theta_0$ であろうが $\theta=\theta_1$ であろうが関係はなく、母数 $\theta$ がとある値であることを仮定しているに過ぎません。そのため、

$$
\lambda(\theta, X) = \frac{L(\theta, X)}{L(\hat{\theta}, X)}
$$

のように、尤度比検定統計量が $\theta$ の関数であると考えることもできます。データ $X$ は固定（実験が終了している）と考えると検定統計量は $\lambda(\theta)$ なので、


* $\lambda(0.1)$ は XXX だったので、受容
* $\lambda(0.01)$ は YYY だったので、棄却
* じゃあ $\lambda(0.05)$ は受容か棄却か？

のように、各 $\theta$ に関して考察することもできます[^1]。



## 漸近正規性

$X_1, ..., X_n \sim f(x, \theta)$ のときに $\theta$ の最尤推定量 $\hat{\theta}$ について

$$
\sqrt{n}(\hat{\theta}_n - \theta) \to_d N(0, 1/I_1(\theta))
$$

が成り立ちます。このことは漸近正規性（asymptotic normality）と呼ばれる性質で、証明は『現代数理統計学の基礎, 第6章 統計的推定』の p.135 辺りに掲載されています。

ワルド検定ではこの性質を用いて、標準正規分布（カイ二乗分布）を用いた検定を行います。$\theta$ の最尤推定量を $\hat{\theta}$ とすると、 検定統計量 $W$ は

$$
W = \sqrt{nI_1(\hat{\theta}_n)} \left( \hat{\theta}_n - \theta \right) \to_d N(0, 1)
$$

となります。こちらも同様、データが固定であると考えると $\theta$ の関数と考えることができるため、各帰無仮説への検定に用いることができます。


## まとめ


ワルド検定は最尤推定量の漸近正規性の性質を用いた検定で、計算の容易さなどのメリットを持っている検定手法です。ただし、尤度比検定はネイマン・ピアソンの補題を用いた一陽斎協力検定であるという「お墨付き」があるため、ワルド検定よりも尤度比検定であるべきだ、という考え方もあるとは思いますが、業界や慣習によって変わってくるものかと思います。一概には何も言えないといったところが、検定論に関してややこしく感じてしまう部分だと改めて感じます。




[^1]: この辺りは [Asymptotic formulae for likelihood-based tests of new physics](https://arxiv.org/pdf/1007.1727) の考え方に影響されているかもしれません。