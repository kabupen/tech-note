---
title: '変数変換'
description: ""
pubDate: 2025-07-06T11:26:58+09:00
heroImage: '@/assets/blog-placeholder-2.jpg'
tags: ["統計"]
---
# 変数変換

何らかの変換により、$X$ が $Y$ に、$(X, Y)$ が $(S, T)$ に変換される問題を想定する。

## 一変量

まず、変換に関する「一対一対応」についてまとめます。
$$
y=g(x)
$$
の変換が一対一対応であるというのは、**$g(x)$ が単調増加もしくは単調減少の関数** の場合に限ります。
単調増減ではない場合関数が上がって下がることにりますが（ex. 二次関数など）、一つの $y$ の値に対して複数の $x$ が対応することとなり、一対一対応にはならないことになります。

そのため、変換 $g$ が単調であればどういった変換であれ、$[x, x+dx]$ の区間が $[y, y+dy]$ の区間に対応することになるため、
$$
f_Y(y)dy = f_X(x)dx
$$
が成り立ちます。この式から、変数変換後の $Y$ が従う確率密度関数は
$$
f_Y(y) = f_X(x) \frac{dx}{dy} = f_X(x) \frac{dg^{-1}(y)}{dy}
$$
と求めることができます [^1]。

[1]: **変換式が単調** であるということは改めて抑えておきましょう（$f$ についてではないです）。


### 例（置換積分）

上記の一変量の変数変換の例は、これまで高校数学でやってきたような、積分計算の変数変換に他なりません。
一変数関数の積分に関する置換積分（変数変換）の公式について導入します。

$$
\int x\sqrt{1+x^2} dx
$$

この場合、

$$
t = 1+x^2
$$

という置換を行い

$$
dt = 2xdx \Leftrightarrow dx = \frac{dt}{2x}
$$

を用いることで

$$
\int x\sqrt{1+x^2} dx = \int x\sqrt{t} \frac{dt}{2x} = \dots
$$

と計算を進めることができます。



## 多変量

多変量の場合の変数変換も同様の議論です。$X=(X_1,...,X_n)$ の $n$ 次元の確率ベクトルを一対一の関数で
$$
Y = 
\begin{pmatrix}
g(X_1) \\\\
\vdots \\\\
g(X_n) 
\end{pmatrix}
$$
として変換する場合の、$Y$ の従う確率密度関数を考えます。一対一対応であることから $[x, x+dx]$ の区間が $[y, y+dy]$ の区間に対応することになるため、
$$
f_{Y_1,...,Y_n}(y_1,...,y_n) dy_1...dy_n = f_{X_1,...,X_n}(x_1,...,x_n) dx_1...dx_n 
$$
が成り立ちます。この式から、変数変換後の $Y$ が従う確率密度関数は
$$
f_{Y_1,...,Y_n}(y_1,...,y_n) = f_{X_1,...,X_n}(x_1,...,x_n) \frac{dx_1...dx_n}{dy_1...dy_n}
$$
と、なればいいのですが、実際にはこの変換係数はヤコビ行列の行列式である **ヤコビアン** と呼ばれる値が使用されます。
ただ、この関係性を覚えておくことでヤコビ行列の組み方の覚えの助けにはなるかと思います。


### ヤコビアン

多変数関数の変数変換の時には、ヤコビアンを用いて微小量を「拡大、縮小」する必要があります。

$$
x = x(u, v) \\\\
y = y(u, v)
$$

を用いた変数変換を行うと、

$$
\int \int f(x, y) dxdy = \int\int g(u, v) |J| dudv
$$

のように変換できます。ここで

$$
J = 
\det\begin{pmatrix}
\frac{\partial x}{\partial u} & \frac{\partial x}{\partial v} \\\\
\frac{\partial y}{\partial u} & \frac{\partial y}{\partial v}
\end{pmatrix}
$$

がヤコビアンと呼ばれる量で、$(x, y)$ 系における微小量を $(u, v)$ 系における微小量へ変換してくれる係数です。


### 微分の順序


ヤコビアンの計算に関する限りは、$x$ と $y$ のどちらを行とどちらを列にとるかは任意です。ただし、何を何で微分すべきかは抑えておく必要があります。


#### 覚え方①


$X$ の従う確率密度関数を $f_X(x)$ としたときに、$Y=g(X)$ の密度関数 $f_Y(y)$ は

$$
f_Y(y) = f_X(g^{-1}(y)) |\det J(\partial x/\partial y)|
$$

と表されます。$x=g^{-1}(y)$ なので

$$
f_Y(y) = f_X(x) |\partial x/\partial y|
$$

のように表しておくと、ヤコビアンの各成分の微分の方向（$\partial \rm{変換元}/\partial \rm{変換先}$）が頭に入りやすいと思います。


#### 覚え方②

ヤコビアンは

$$
dxdy = |J| dudv
$$

の係数であるので、これを変換すると

$$
|J| = \frac{dxdy}{dudv}
$$

となり、何を何で微分すべきかを思い出せると思います。